<div class="dialog-backdrop">
  <div class="dialog-container">
    <div class="dialog-header">
      <button class="close-btn" (click)="onClose()">
        <img src="/assets/icons/close-icon.svg" alt="Close" />
      </button>
      <img src="/assets/icons/document-icon.svg" alt="Document" class="document-icon" />
      <h2>{{ isEditMode ? 'חוב - ' + debt.description : 'יצירת חוב חדש' }}</h2>
      <div class="header-left">
        @if (isEditMode && debt.lastReminder) {
          <div class="info-message">
            <img src="/assets/icons/info-icon.svg" alt="Info" class="info-icon" />
            <span>נשלחה תזכורת לגבי חוב זה בתאריך: {{ formatDate(debt.lastReminder) }}</span>
          </div>
        }
      </div>
    </div>

    <form (ngSubmit)="onSubmit()">
      <div class="form-content">
        <div class="form-grid">
          <!-- Right Column -->
          <div class="form-column-right">
            <div class="form-group">
              <label class="required">סוג חייב:</label>
              <div class="radio-group">
                <label class="radio-option">
                  <input type="radio" name="debtorType" value="group" [(ngModel)]="debtorType">
                  <span class="radio-label">קבוצה</span>
                </label>
                <label class="radio-option">
                  <input type="radio" name="debtorType" value="individual" [(ngModel)]="debtorType">
                  <span class="radio-label">יחיד</span>
                </label>
              </div>
            </div>
            <div class="form-group">
              <label>סכום:</label>
              <div class="amount-input">
                <input type="number" [(ngModel)]="debt.amount" name="amount" placeholder="">
                <span class="currency">₪</span>
              </div>
            </div>
            <div class="form-group">
              <label>תיאור חוב:</label>
              <textarea [(ngModel)]="debt.description" name="description" placeholder="" rows="3"></textarea>
            </div>
          </div>

          <!-- Left Column -->
          <div class="form-column-left">
            <div class="form-group">
              <label class="required">חייב:</label>
              <app-member-autocomplete
                [memberName]="debt.fullName"
                (memberSelected)="onMemberSelected($event)"
                placeholder="חיפוש חייב..."
              ></app-member-autocomplete>
            </div>
            <div class="form-group">
              <label class="required">סוג חוב:</label>
              <app-custom-select
                [options]="debtTypeOptions"
                [(value)]="debt.debtType"
                placeholder="בחר סוג חוב"
              ></app-custom-select>
            </div>
            <div class="form-group">
              <label class="required">תאריך:</label>
              <input type="date" [(ngModel)]="debt.gregorianDate" name="gregorianDate">
            </div>
          </div>
        </div>
      </div>

      <div class="form-actions">
        @if (isEditMode) {
          <button type="button" class="btn-delete" (click)="onDelete()">
            <img src="/assets/icons/trash-icon.svg" alt="Delete" class="btn-icon" />
            מחק חוב
          </button>
        }
        <div class="actions-right">
          @if (isEditMode) {
            <button type="button" class="btn-pay" (click)="onPay()">
              <img src="/assets/icons/shekel-icon.svg" alt="Pay" class="btn-icon" />
              שלם
            </button>
            <button type="button" class="btn-reminder" (click)="onSendReminder()">
              <img src="/assets/icons/message-icon.svg" alt="Reminder" class="btn-icon" />
              שלח תזכורת
            </button>
          }
          <button type="submit" class="btn-save" [disabled]="isSubmitting">
            <img src="/assets/icons/document-icon.svg" alt="Save" class="btn-icon" />
            {{ isSubmitting ? 'שומר...' : 'שמור שינויים' }}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
